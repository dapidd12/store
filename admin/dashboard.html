<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
  <header>
    <h1>Dashboard</h1>
  </header>

  <main>
    <section>
      <canvas id="dashboard-chart" width="400" height="200"></canvas>
      <button id="refresh-btn">Refresh</button>
    </section>
  </main>

  <!-- Load UI utilities first so pages can use safeAddListener -->
  <script src="/js/utils-ui.js"></script>
  <!-- Provide a small fallback in case utils-ui failed to load so existing inline scripts can call safeAddListener -->
  <script>
    if (!window.__utilsUI) {
      window.__utilsUI = {
        safeAddListener: function(el, ev, fn, opts) {
          if (!el) return;
          el.addEventListener(ev, fn, opts);
        }
      };
    }
  </script>

  <!-- Page specific inline scripts should use safeAddListener or guard getElementById -->
  <script>
    (function(){
      var refreshBtn = document.getElementById('refresh-btn');
      if (refreshBtn) {
        // Prefer the safeAddListener provided by utils-ui
        (window.__utilsUI?.safeAddListener || function(el, ev, fn, opts){ if(el) el.addEventListener(ev, fn, opts); })(refreshBtn, 'click', function(){
          // Refresh handler
          console.log('Dashboard refresh clicked');
        });
      }

      // Chart initialization guarded in separate admin JS file, but keep a safe check here if needed
      var ctx = document.getElementById('dashboard-chart');
      if (!ctx) return;
      // Do not initialize charts inline here â€” admin JS will handle chart creation safely
    })();
  </script>

  <script src="/js/admin-dashboard.js"></script>
</body>
</html>
